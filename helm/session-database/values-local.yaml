---
# Local deployment values with NodePort for external access
# Use this file for local Kubernetes clusters (minikube, k3s, kind, microk8s, etc.)
#
# Usage:
#   helm install session-database ./helm/session-database \
#     --namespace session-database --create-namespace \
#     --values ./helm/session-database/values-local.yaml
#
# Access Redis via: redis-cli -h $(minikube ip) -p 30379 -a $REDIS_PASSWORD

# Image configuration for local development
image:
  repository: session-database
  tag: "latest"
  pullPolicy: IfNotPresent

# Deployment mode - sentinel for HA testing, standalone for simple setup
deploymentMode: sentinel

# Service configuration with NodePort enabled for external access
service:
  type: NodePort
  port: 6379
  targetPort: 6379
  nodePort:
    enabled: true
    port: 30379

  sentinel:
    type: NodePort
    port: 26379
    targetPort: 26379
    nodePort:
      enabled: true
      port: 30380

# Reduced HA configuration for local development
ha:
  sentinel:
    enabled: true
    replicas: 1
    resources:
      requests:
        memory: "64Mi"
        cpu: "50m"
      limits:
        memory: "128Mi"
        cpu: "100m"

  master:
    replicas: 1
    persistence:
      enabled: true
      size: "1Gi"
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
        ephemeralStorage: "512Mi"
      limits:
        memory: "512Mi"
        cpu: "200m"
        ephemeralStorage: "1Gi"

  replica:
    replicas: 1
    persistence:
      enabled: false
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
        ephemeralStorage: "256Mi"
      limits:
        memory: "256Mi"
        cpu: "100m"
        ephemeralStorage: "512Mi"

# Minimal monitoring for local development
monitoring:
  enabled: true

  prometheus:
    enabled: true
    replicas: 1
    retention: "24h"
    scrapeInterval: "30s"
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "200m"

  grafana:
    enabled: true
    replicas: 1
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
      limits:
        memory: "256Mi"
        cpu: "100m"

  alertmanager:
    enabled: false

  redisExporter:
    enabled: true
    resources:
      requests:
        memory: "16Mi"
        cpu: "5m"
      limits:
        memory: "32Mi"
        cpu: "25m"

# Relaxed security for local development
security:
  podSecurityStandards:
    enabled: true
    enforce: "baseline"
  networkPolicies:
    enabled: false

# Disable autoscaling locally
autoscaling:
  enabled: false

# Disable PDB for local (single replica)
podDisruptionBudget:
  enabled: false
